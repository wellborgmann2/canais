<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video.js Example</title>

    <!-- Estilos do Video.js -->
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" />
    
    <!-- Biblioteca Video.js -->
    <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script>

    <!-- Biblioteca para HLS -->
    <script src="https://unpkg.com/videojs-http-streaming@latest/dist/videojs-http-streaming.min.js"></script>

    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #121212;
        color: white;
      }
      .video-js {
        width: 100%;
        max-width: 800px;
        height: 500px;
      }
      nav {
        position: absolute;
        top: 10px;
        left: 10px;
      }
      .back {
        background: #ff0000;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <nav><div class="back" onclick="window.history.back()">Voltar</div></nav>

    <video
      id="my-video"
      class="video-js vjs-default-skin"
      controls
      preload="auto"
    >
      <p>Seu navegador não suporta a reprodução de vídeos.</p>
    </video>

    <script>
      // Captura o valor da URL dos parâmetros da URL
      const urlParams = new URLSearchParams(window.location.search);
      const streamingUrl = urlParams.get("url"); // Obtém o valor do parâmetro 'url'

      if (streamingUrl) {
        // Inicializa o player Video.js
        var player = videojs("my-video", {
          techOrder: ["html5"],
          html5: {
            vhs: {
              overrideNative: true, // Garante que o HLS seja tratado corretamente
              withCredentials: false, 
            }
          }
        });

        // Define a URL do vídeo dinamicamente
        player.src({
          src: streamingUrl,
          type: "application/x-mpegURL",
        });

        // Eventos de erro
        player.on("error", function () {
          console.error("Ocorreu um erro ao carregar o vídeo.");
        });

        player.on("loadedmetadata", function () {
          console.log("O vídeo foi carregado com sucesso.");
        });

      } else {
        console.error("Nenhuma URL de streaming fornecida.");
      }
    </script>
  </body>
</html>
